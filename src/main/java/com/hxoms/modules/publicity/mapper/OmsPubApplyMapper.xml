<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hxoms.modules.publicity.mapper.OmsPubApplyMapper">
    <resultMap id="BaseResultMap" type="com.hxoms.modules.publicity.entity.OmsPubApply">
        <id column="ID" jdbcType="VARCHAR" property="id"/>
        <result column="A0100" jdbcType="VARCHAR" property="a0100"/>
        <result column="B0100" jdbcType="VARCHAR" property="b0100"/>
        <result column="YSP_ID" jdbcType="VARCHAR" property="yspId"/>
        <result column="YSPDW_ID" jdbcType="VARCHAR" property="yspdwId"/>
        <result column="AGE" jdbcType="VARCHAR" property="age"/>
        <result column="POLITICAL_AFF" jdbcType="VARCHAR" property="politicalAff"/>
        <result column="JOB" jdbcType="VARCHAR" property="job"/>
        <result column="HEALTH" jdbcType="VARCHAR" property="health"/>
        <result column="SFSMRY" jdbcType="CHAR" property="sfsmry"/>
        <result column="SMDJ" jdbcType="VARCHAR" property="smdj"/>
        <result column="NSSJ" jdbcType="TIMESTAMP" property="nssj"/>
        <result column="YSMDJ1" jdbcType="VARCHAR" property="ysmdj1"/>
        <result column="YTMJSSJ1" jdbcType="TIMESTAMP" property="ytmjssj1"/>
        <result column="YSMDJ2" jdbcType="VARCHAR" property="ysmdj2"/>
        <result column="YTMJSSJ2" jdbcType="TIMESTAMP" property="ytmjssj2"/>
        <result column="ZTDW" jdbcType="VARCHAR" property="ztdw"/>
        <result column="ZTNRZW" jdbcType="VARCHAR" property="ztnrzw"/>
        <result column="CGSJ" jdbcType="TIMESTAMP" property="cgsj"/>
        <result column="HGSJ" jdbcType="TIMESTAMP" property="hgsj"/>
        <result column="SDGJ" jdbcType="VARCHAR" property="sdgj"/>
        <result column="TLSJ" jdbcType="VARCHAR" property="tlsj"/>
        <result column="CFRW" jdbcType="VARCHAR" property="cfrw"/>
        <result column="CFSY" jdbcType="VARCHAR" property="cfsy"/>
        <result column="CGSPDW" jdbcType="VARCHAR" property="cgspdw"/>
        <result column="PWH" jdbcType="VARCHAR" property="pwh"/>
        <result column="ZYPWH" jdbcType="VARCHAR" property="zypwh"/>
        <result column="ZJCGQK" jdbcType="VARCHAR" property="zjcgqk"/>
        <result column="SJCGSJ" jdbcType="TIMESTAMP" property="sjcgsj"/>
        <result column="SJHGSJ" jdbcType="TIMESTAMP" property="sjhgsj"/>
        <result column="NFGS" jdbcType="CHAR" property="nfgs"/>
        <result column="SFYSP" jdbcType="CHAR" property="sfysp"/>
        <result column="SFZQJWYJ" jdbcType="CHAR" property="sfzqjwyj"/>
        <result column="SCZQJWYJSJ" jdbcType="TIMESTAMP" property="sczqjwyjsj"/>
        <result column="SFBCZQJWYJ" jdbcType="CHAR" property="sfbczqjwyj"/>
        <result column="JWJL" jdbcType="CHAR" property="jwjl"/>
        <result column="CLSHSFTG" jdbcType="CHAR" property="clshsftg"/>
        <result column="JDCJL" jdbcType="CHAR" property="jdcjl"/>
        <result column="SFZYLD" jdbcType="CHAR" property="sfzyld"/>
        <result column="SFLG" jdbcType="CHAR" property="sflg"/>
        <result column="POZNSJD" jdbcType="CHAR" property="poznsjd"/>
        <result column="FMXX" jdbcType="VARCHAR" property="fmxx"/>
        <result column="DWJSXS" jdbcType="CHAR" property="dwjsxs"/>
        <result column="ZZJL" jdbcType="CHAR" property="zzjl"/>
        <result column="CXYY" jdbcType="VARCHAR" property="cxyy"/>
        <result column="SFTSRY" jdbcType="CHAR" property="sftsry"/>
        <result column="SFZB" jdbcType="CHAR" property="sfzb"/>
        <result column="SFBG" jdbcType="CHAR" property="sfbg"/>
        <result column="SQZT" jdbcType="CHAR" property="sqzt"/>
        <result column="CREATE_USER" jdbcType="VARCHAR" property="createUser"/>
        <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="MODIFY_USER" jdbcType="VARCHAR" property="modifyUser"/>
        <result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime"/>
        <result column="SORT_ID" jdbcType="INTEGER" property="sortId"/>
    </resultMap>
    <sql id="Base_Column_List">
    ID, A0100, B0100, YSP_ID, YSPDW_ID, AGE, POLITICAL_AFF, JOB, HEALTH, SFSMRY, SMDJ, 
    NSSJ, YSMDJ1, YTMJSSJ1, YSMDJ2, YTMJSSJ2, ZTDW, ZTNRZW, CGSJ, HGSJ, SDGJ, TLSJ, CFRW, 
    CFSY, CGSPDW, PWH, ZYPWH, ZJCGQK, SJCGSJ, SJHGSJ, NFGS, SFYSP, SFZQJWYJ, SCZQJWYJSJ, 
    SFBCZQJWYJ, JWJL, CLSHSFTG, JDCJL, SFZYLD, SFLG, POZNSJD, FMXX, DWJSXS, ZZJL, CXYY, 
    SFTSRY, SFZB, SFBG, SQZT, CREATE_USER, CREATE_TIME, MODIFY_USER, MODIFY_TIME, SORT_ID
  </sql>

    <select id="selectPersonListByOrg" resultType="com.hxoms.modules.publicity.entity.PersonInfoVO">
    SELECT
    *
    FROM  OMS_PERSONINFO P
    where p.b0100=#{b0100}
  </select>
    <select id="selectBasePersonInfo" resultType="java.util.Map">
        select distinct concat(p.SURNAME,p.NAME) as NAME
        ,p.SEX
        ,p.BIRTH_DATE
        ,CONCAT(TIMESTAMPDIFF(YEAR,p.BIRTH_DATE,DATE_FORMAT(NOW(), '%Y.%m.%d')),'') as AGE
        ,p.POLITICAL_AFFI
        ,p.HEALTH
        ,p.A0100
        ,p.SECRET_LEVEL
        ,p.NF
        ,i.JOB
        ,i.B0100
        ,i.B0101
         from oms_reg_procpersoninfo p inner join oms_personinfo i on p.a0100=i.a0100
         where i.b0100=#{b0100} and i.a0100=#{a0100}
    </select>
    <select id="selectPubAbroadLatestInfo" resultType="com.hxoms.modules.publicity.entity.OmsPubApply">
        select * from oms_pub_apply p where p.cgsj
        =(select max(cgsj) from oms_pub_apply where a0100=#{a0100})
        and a0100 = #{a0100}
    </select>

    <select id="selectCheckCondition" resultType="com.hxoms.modules.condition.entity.OmsCondition">
    select * from oms_condition where condition_type=#{conditionType}
  </select>
    <select id="excuteSelectSql" resultType="java.lang.Integer">
        ${sql}
    </select>
    <select id="selectPubApplyList" resultType="com.hxoms.modules.publicity.entity.OmsPubApplyVO">
        select
        oms_pub_apply.ID
        ,oms_pub_apply.CGSJ
        ,oms_pub_apply.HGSJ
        ,oms_pub_apply.CFRW
        ,oms_pub_apply.SDGJ
        ,oms_pub_apply.CFSY
        ,oms_pub_apply.JOB
        ,oms_pub_apply.CREATE_TIME
        ,oms_pub_apply.SMDJ
        ,oms_pub_apply.FMXX
        ,oms_pub_apply.SFBG
        ,GETDICTITEM('37',oms_pub_apply.sflg,'0') as "SFLG"
        ,GETDICTITEM('37',oms_pub_apply.sfzyld,'0') as "SFZYLD"
        ,GETDICTITEM('37',oms_pub_apply.sfbg,'0') as "SFBG"
        ,GETDICTITEM('37',oms_pub_apply.SFZYLD,'0') as "SFZYLD"
        ,GETDICTITEM('300',oms_pub_apply.SQZT,'0') as "SQZT"
        ,concat(oms_reg_procpersoninfo.surname,oms_reg_procpersoninfo.name) as "NAME"
        ,oms_reg_procpersoninfo.SEX
        ,oms_reg_procpersoninfo.BIRTH_DATE
        ,oms_reg_procpersoninfo.NATION
        ,oms_reg_procpersoninfo.POLITICAL_AFFI
        from oms_pub_apply
        inner join oms_b01_temp on oms_pub_apply.b0100=oms_b01_temp.b0100
        left join oms_reg_procpersoninfo on oms_pub_apply.a0100=oms_reg_procpersoninfo.a0100
        where oms_b01_temp.batch_id=#{batchId} and oms_pub_apply.SQZT!='0'
        order by oms_pub_apply.SQZT,oms_pub_apply.cgsj
    </select>
    <select id="selectPersonInfoByApplyId" resultType="java.util.Map">
        select concat(b.SURNAME,b.name) as "NAME"
        ,b.SEX,b.BIRTH_DATE,a.POLITICAL_AFF,b1.B0101,a.JOB,a.HEALTH
        ,GETDICTITEM('37',a.SFSMRY,'0') as "SFSMRY",a.SMDJ,a.NSSJ
        ,a.YSMDJ1,a.YTMJSSJ1,a.YSMDJ2,a.YTMJSSJ2,a.ZTDW,a.ZTNRZW,a.CGSJ
        ,a.HGSJ,a.SDGJ,a.TLSJ,a.CFRW,a.CGSPDW,a.PWH,a.ZJCGQK
        from oms_pub_apply a inner join oms_reg_procpersoninfo b
        on a.a0100=b.a0100
        inner join b01 b1 on a.b0100=b1.b0100
        where a.id=#{applyId}
    </select>
    <select id="selectById" resultType="com.hxoms.modules.publicity.entity.OmsPubApplyVO">
        select concat(r.SURNAME,r.name) as "NAME",r.SEX,r.BIRTH_DATE,b.B0101
        ,o.* from oms_pub_apply o inner join oms_reg_procpersoninfo r
        on o.a0100=r.a0100
        inner join b01 b on o.b0100=b.b0100
        where o.id=#{id}
    </select>

</mapper>